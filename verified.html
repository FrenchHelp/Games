<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>PlayHub • Verified Games</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <style>
    body {
      margin: 0;
      font-family: system-ui, sans-serif;
      background: #0b0f16;
      color: #e6edf3;
    }

    header {
      padding: 1rem;
      background: #121826;
      display: flex;
      gap: 1rem;
      align-items: center;
      flex-wrap: wrap;
      border-bottom: 1px solid #22283a;
    }

    header h1 {
      font-size: 1.1rem;
      margin: 0;
      font-weight: 700;
      letter-spacing: .3px;
    }

    input, select {
      background: #0b0f16;
      color: #e6edf3;
      border: 1px solid #2a314a;
      padding: .5rem;
      border-radius: 6px;
    }

    main {
      padding: 1rem;
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
      gap: 1rem;
    }

    .card {
      background: #151c2f;
      border-radius: 12px;
      padding: .9rem;
      text-align: center;
      cursor: pointer;
      border: 1px solid #2a314a;
      transition: transform .15s ease, box-shadow .15s ease;
    }

    .card:hover {
      transform: translateY(-4px);
      box-shadow: 0 0 16px rgba(90,120,255,.3);
    }

    .card img {
      width: 96px;
      height: 96px;
      object-fit: contain;
      margin-bottom: .6rem;
    }

    .name {
      font-size: .9rem;
      font-weight: 600;
    }

    .badge {
      display: inline-block;
      margin-top: .35rem;
      font-size: .65rem;
      padding: .15rem .4rem;
      border-radius: 999px;
      background: #22c55e;
      color: #04120a;
      font-weight: 700;
    }
  </style>
</head>

<body>

<header>
  <h1>✔ Verified Games</h1>

  <input id="search" placeholder="Search verified games…" />

  <select id="sort">
    <option value="name" selected>Sort: Name</option>
    <option value="popularity">Sort: Popularity</option>
  </select>
</header>

<main>
  <div id="grid" class="grid"></div>
</main>

<script>
let games = [];
let filtered = [];
let searchTimer;

fetch("verified.json")
  .then(r => r.json())
  .then(data => {
    games = data.map(g => ({ ...g, popularity: g.popularity ?? 0 }));
    applyFilter();
  });

const searchInput = document.getElementById("search");
const sortSelect = document.getElementById("sort");

searchInput.oninput = () => {
  clearTimeout(searchTimer);
  searchTimer = setTimeout(applyFilter, 120);
};

sortSelect.onchange = applyFilter;

function applyFilter() {
  const q = searchInput.value.toLowerCase();

  filtered = games.filter(g =>
    g.name.toLowerCase().includes(q)
  );

  if (sortSelect.value === "popularity") {
    filtered.sort((a,b) => b.popularity - a.popularity);
  } else {
    filtered.sort((a,b) => a.name.localeCompare(b.name));
  }

  render();
}

function render() {
  const grid = document.getElementById("grid");
  grid.innerHTML = "";

  const frag = document.createDocumentFragment();

  for (const g of filtered) {
    const card = document.createElement("div");
    card.className = "card";

    const img = document.createElement("img");
    img.loading = "lazy";
    img.src = `assets/game-icons/${g.image}`;

    const name = document.createElement("div");
    name.className = "name";
    name.textContent = g.name;

    const badge = document.createElement("div");
    badge.className = "badge";
    badge.textContent = "VERIFIED";

    card.onclick = () => openGame(g.path);

    card.append(img, name, badge);
    frag.appendChild(card);
  }

  grid.appendChild(frag);
}

function openGame(path) {
  const win = window.open("about:blank", "_blank");
  win.document.body.style.margin = "0";
  win.document.body.style.background = "black";

  const iframe = win.document.createElement("iframe");
  iframe.src = `games/${path}`;
  iframe.style.width = "100%";
  iframe.style.height = "100vh";
  iframe.style.border = "none";

  win.document.body.appendChild(iframe);
}
</script>

</body>
</html>
